{% extends 'admin/base_admin.html' %}
{% load static %}
{% block navbar %}
{% include 'admin/navbar_admin.html' %}
{% endblock %}


{% block sidebar %}
{% include 'admin/sidebar_admin.html' %}
{% endblock %}

{% block footer %}
{% include 'admin/footer_admin.html' %}
{% endblock %}



{% block css %}
<link rel="stylesheet" href="{% static 'admin/css/dataTables.bootstrap4.min.css' %}"/>
{% endblock %}

{% block content %}
<div class="container py-2">

    <h2 align="center" class="customColor pt-2">Historique des commandes</h2>



    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <a href="{% url 'product:createOrder' %}" class="btn btn-default float-right pl-2"> Ajouter une commande </a><br/>
        </div>
        <div class="card-body">
            <div class="table-responsive">

                <table id="example" class="table table-striped table-bordered">
                    <thead>
                    <tr>
                        <th>N° Référence</th>
                        <th>Client</th>
                        <th>Produits</th>
                        <th>Total <small>(fcfa)</small></th>
                        <th>Date</th>
                        <th>Statut</th>
                        <th>Livraison</th>
                        <th>Action</th>
                    </tr>
                    </thead>
                    <tbody>

                    {% for order in orders %}
                    <tr>
                        <td><a href="{% url 'product:detailOrder' order.id %}" style="text-decoration: none;">{{ order.ref_code   }}</a></td>
                        <td>{{ order.user.fullname   }}</td>
                        <td>{{ order.produits.count   }}</td>
                        <td>{{ order.get_total }}</td>
                        <td>{{ order.ordered_date }}</td>
                        <td class="mx-auto pl-4">{% if order.ordered ==  False  %}<span class="badge badge-success"> En cours </span>{% else %}<span class="badge badge-success"> Terminé </span>{% endif %}</td>
                        <td class="mx-auto pl-4">{% if order.being_delivered ==  False  %}<span class="badge badge-success"> Non livré </span>{% elif order.being_delivered ==  True and order.received == False  %}<span class="badge badge-success"> En cours de livraison </span>{% elif order.being_delivered ==  True and order.received == True  %}<span class="badge badge-success"> Reçu </span>{% endif %}</td>
                        <td><!--a href="{% url 'product:editOrder' order.id %}" style="text-decoration: none;" class="text-success"><i class="fa fa-edit mx-2"--></i></a>
                            <a href="{% url 'product:deleteOrder' order.id %}" style="text-decoration: none;" class="text-primary px-2" data-toggle="modal" data-target="#centralModalWarning"><i class="fa fa-eye"></i></a>
                           
                         <!-- Central Modal Medium Warning -->
						 <div class="modal fade" id="centralModalWarning" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
						   <div class="modal-dialog modal-notify" role="document">
						     <!--Content-->
						     <div class="modal-content">
						       <!--Header-->
						       <div class="modal-header  bg-default">
						         <p class="heading lead">N° Commande: {{ order.ref_code   }}</p>
						
						         <button type="button" class="close" data-dismiss="modal" aria-label="Close">
						           <span aria-hidden="true" class="white-text">&times;</span>
						         </button>
						       </div>
						
						       <!--Body-->
						       <div class="modal-body">
						         <div class="">
						           <!--i class="fas fa-check fa-4x mb-3 animated rotateIn"></i-->
						           <div class="row">
						           		<div class="col-md-6">
						           			<small>{{ order.user.firstname   }} {{ order.user.lastname   }}</small><br/>
								            <small>{{ order.shipping_address.twon }}</small><br/>
								            <small>{{ order.shipping_address.street_address }}</small><br/>
								            <small>Tel: {{ order.shipping_address.tel }}</small><br/>
						           		</div>
						           		<div class="col-md-6 float-right">
										    <a class="navbar-brand font-weight-bold" href="/"><strong>PROXI<span class="text-danger">Market</span></strong></a>
										</div>
						           </div><br/>
						           
						           <div class="table-wrapper-scroll-y my-custom-scrollbar text-center">

										  <table class="table table-bordered table-striped mb-0">
										    <thead>
										      <tr>
										        <th scope="col">#</th>
										        <th scope="col">Produit</th>
										        <th scope="col">Qté</th>
										        <th scope="col">Prix</th>
										        <th scope="col">Total</th>
										      </tr>
										    </thead>
										    <tbody>
										    	{% for p in order.get_items %}
												      <tr>
												        <th scope="row">1</th>
												        <td>Mark</td>
												        <td>2</td>
												        <td>5000</td>
												        <td>10000</td>
												      </tr>
										    	{% endfor %}
										    </tbody>
										  </table>
										  <br/>
										<strong>TOTAL: 50000 fcfa</strong>
								    </div>
						           
									<!-- Horizontal Steppers -->
									<div class="row">
									  <div class="col-md-12">
									
									    <!-- Stepers Wrapper -->
									    <ul class="stepper stepper-horizontal">
									
									      <!-- First Step -->
									      <li class="completed">
									        <a href="#!">
									          <span class="label"> - </span>
									        </a>
									      </li>
									
									      <!-- Second Step -->
									      <li class="active">
									        <a href="#!">
									          <span class="circle">0</span>
									          <span class="label">{{ order.status }}</span>
									        </a>
									      </li>
									
									      <!-- Third Step -->
									      <li class="active">
									        <a href="#!">
									          <span class="label"> - </span>
									        </a>
									      </li>
									
									    </ul>
									    <!-- /.Stepers Wrapper -->
									
									  </div>
									</div>
									<!-- /.Horizontal Steppers -->
						         </div>
						       </div>
						
						       <!--Footer-->
						       <div class="modal-footer justify-content-center">
						         <a type="button" class="btn btn-danger text-white" href="#">Imprimer la facture</a>
						         <a type="button" class="btn btn-default text-white" href="#">Traiter</a>
						       </div>
						     </div>
						     <!--/.Content-->
						   </div>
						 </div>
						 <!-- Central Modal Medium Warning-->
                         </td>
                    </tr>
                    
                    {% endfor %}
                    </tbody>
                </table>

            </div>
        </div>
    </div>
</div>


{% endblock %}


{% block script %}

<script src="{% static 'admin/js/jquery.dataTables.min.js' %}"></script>

<script src="{% static 'admin/js/dataTables.bootstrap4.min.js' %}"></script>
<script>


    $(document).ready(function() {
       $('#example').DataTable( {
    language: {
        processing:     "Traitement en cours...",
        search:         "Rechercher&nbsp;:",
        lengthMenu:     "Afficher _MENU_ &eacute;l&eacute;ments",
        info:           "Affichage de _START_ &agrave; _END_ sur _TOTAL_ &eacute;l&eacute;ments",
        infoEmpty:      "Affichage de 0 &agrave; 0 sur 0 &eacute;l&eacute;ments",
        infoFiltered:   "(filtr&eacute; de _MAX_ &eacute;l&eacute;ments au total)",
        infoPostFix:    "",
        loadingRecords: "Chargement en cours...",
        zeroRecords:    "Aucun &eacute;l&eacute;ment &agrave; afficher",
        emptyTable:     "Aucune donnée disponible dans le tableau",
        paginate: {
            first:      "Premier",
            previous:   "Pr&eacute;c&eacute;dent",
            next:       "Suivant",
            last:       "Dernier"
        },
        aria: {
            sortAscending:  ": activer pour trier la colonne par ordre croissant",
            sortDescending: ": activer pour trier la colonne par ordre décroissant"
        }
    }
} );
    } );
</script>

<script>
    setTimeout(function(){
      if ($('#msg').length > 0) {
        $('#msg').remove();
      }
     },5000)

</script>

{% endblock %}


